#include <tunables/global>

profile your-addon flags (attach_disconnected,mediate_deleted) {
  #include <abstractions/base>

  # Allow network access if needed
  network inet tcp,
  network inet udp,

  # Allow read/write access to add-on data directory
  /data/** rw,

  # Allow access to temporary files
  /tmp/** rw,

  # Allow access to common system files needed for basic operation
  /etc/hosts r,
  /etc/resolv.conf r,
  /etc/localtime r,
  /etc/timezone r,

  # Allow access to proc for basic system information
  /proc/version r,
  /proc/meminfo r,
  /proc/cpuinfo r,
  /proc/uptime r,

  # Deny access to sensitive system files
  deny /etc/shadow r,
  deny /etc/passwd r,
  deny /etc/gshadow r,
  deny /etc/group r,

  # Deny access to other proc files that could leak information
  deny /proc/** r,

  # Allow access to devices if needed (uncomment if required)
  # /dev/ttyAMA0 rw,
  # /dev/null rw,
  # /dev/zero r,
  # /dev/random r,
  # /dev/urandom r,

  # Allow access to SSL certificates
  /etc/ssl/certs/** r,
  /usr/share/ca-certificates/** r,
}